---
title: Guía de referencia de las reglas de valoración de vulnerabilidades de SQL
description: Lista de títulos y descripciones de reglas para SQL Server, Azure SQL Database, Instancia administrada de Azure SQL y Azure Synapse Analytics
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: reference
author: davidtrigano
ms.author: datrigan
ms.reviewer: vanto
ms.date: 12/14/2020
ms.openlocfilehash: ba6a3313707ca0124c9880a66376ea7a4d9977c1
ms.sourcegitcommit: 8245325f9170371e08bbc66da7a6c292bbbd94cc
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/07/2021
ms.locfileid: "99806331"
---
# <a name="sql-vulnerability-assessment-rules-reference-guide"></a>Guía de referencia de las reglas de valoración de vulnerabilidades de SQL
[!INCLUDE[appliesto-sqldb-sqlmi-asa](../includes/appliesto-sqldb-sqlmi-asa.md)]

En este artículo se enumera el conjunto de reglas integradas que se usan para marcar las vulnerabilidades de seguridad y resaltar las desviaciones con respecto a los procedimientos recomendados, como errores de configuración, permisos excesivos y datos confidenciales sin protección. Las reglas se basan en los procedimientos recomendados de Microsoft y se centran en los problemas de seguridad que presentan mayores riesgos para la base de datos y sus valiosos datos. Tratan los problemas de nivel de base de datos, así como los problemas de seguridad de nivel de servidor, como la configuración del firewall de servidor y los permisos de nivel de servidor. Estas reglas también representan muchos de los requisitos que deben cumplir diversos organismos reguladores para satisfacer los estándares de cumplimiento.

Las reglas que se muestran en sus exámenes de base de datos dependen de la versión de SQL y de la plataforma examinada. 

Para obtener información sobre cómo implementar la evaluación de vulnerabilidades en Azure, consulte [Implementación de una evaluación de vulnerabilidades](./sql-vulnerability-assessment.md#configure-vulnerability-assessment).

Para obtener una lista de los cambios realizados en estas reglas, consulte [Registro de cambios de reglas de valoración de vulnerabilidades de SQL](sql-database-vulnerability-assessment-rules-changelog.md).

## <a name="rule-categories"></a>Categorías de las reglas

Las reglas de evaluación de vulnerabilidades de SQL tienen cinco categorías, que se encuentran en las secciones siguientes:

- [Autenticación y autorización](#authentication-and-authorization)
- [Auditoría y registro](#auditing-and-logging)
- [Protección de datos](#data-protection)
- [Actualizaciones y revisiones de instalación](#installation-updates-and-patches)
- [Reducción del área expuesta](#surface-area-reduction)

<sup>1</sup> **SQL Server 2012+** se refiere a todas las versiones de SQL Server 2012 y posteriores.

<sup>2</sup> **SQL Server 2017+** se refiere a todas las versiones de SQL Server 2017 y posteriores.

<sup>3</sup> **SQL Server 2016+** se refiere a todas las versiones de SQL Server 2016 y posteriores.

## <a name="authentication-and-authorization"></a>Autenticación y autorización

|Id. de regla  |Título de la regla   |Gravedad de la regla  |Descripción de la regla  |Plataforma  |
|---------|---------|---------|---------|---------|
| VA1017     |Se deben revocar los permisos de ejecución en xp_cmdshell de todos los usuarios (excepto dbo)          |Alto         |El procedimiento almacenado extendido xp_cmdshell genera un shell de comandos de Windows, para lo cual pasa una cadena para su ejecución. Esta regla comprueba que ningún usuario (excepto aquellos que tengan el permiso CONTROL SERVER como, por ejemplo, los miembros del rol del servidor sysadmin) tenga permiso para ejecutar el procedimiento almacenado extendido xp_cmdshell.         |<nobr>SQL Server 2012+<sup>1</sup><nobr/>         |
|VA1020     |El usuario de base de datos GUEST no debe ser miembro de ningún rol.          |Alto         |El usuario invitado permite el acceso a una base de datos para todos los inicios de sesión que no estén asignados a un usuario de base de datos específico. Esta regla comprueba que no hay roles de base de datos asignados al usuario invitado.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1042     |El encadenamiento de propiedad de base de datos se debe deshabilitar para todas las bases de datos, excepto `master`, `msdb` y `tempdb`.          |Alto         |El encadenamiento de propiedad entre bases de datos es una extensión del encadenamiento de propiedad, excepto por el hecho de que supera el límite de las bases de datos. Esta regla comprueba que esta opción esté deshabilitada para todas las bases de datos, excepto `master`, `msdb` y `tempdb`. Para `master`, `msdb` y `tempdb`, el encadenamiento de propiedad entre bases de datos está habilitado de forma predeterminada.        |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1043     |La entidad de seguridad GUEST no debe tener acceso a ninguna base de datos de usuario.          |Media         |El usuario invitado permite el acceso a una base de datos para todos los inicios de sesión que no estén asignados a un usuario de base de datos específico. Esta regla comprueba que el usuario invitado no pueda conectarse a ninguna base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL        |
|VA1046     |CHECK_POLICY debe estar habilitado para todos los inicios de sesión de SQL.          |Bajo         |La opción CHECK_POLICY permite comprobar los inicios de sesión de SQL en la directiva de dominio. Esta regla comprueba que la opción CHECK_POLICY esté habilitada para todos los inicios de sesión de SQL.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1047     |La comprobación de expiración de contraseñas debe estar habilitada para todos los inicios de sesión de SQL.          |Bajo         |Las directivas de expiración de contraseñas se utilizan para administrar la duración de una contraseña. Cuando SQL Server aplica la directiva de expiración de contraseñas, se recuerda a los usuarios que cambien las contraseñas antiguas y las cuentas con contraseñas que han expirado se deshabilitan. Esta regla comprueba que la directiva de expiración de contraseñas esté habilitada para todos los inicios de sesión de SQL.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1048     |Las entidades de seguridad de base de datos no deben asignarse a la cuenta `sa`.          |Alto         |Un atacante podría usar la entidad de seguridad de base de datos asignada a la cuenta `sa` para elevar permisos a `sysadmin`.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1052     |Quitar BUILTIN\Administrators como un inicio de sesión de servidor          |Bajo         |El grupo BUILTIN\Administrators contiene el grupo de administradores locales de Windows. En versiones anteriores de Microsoft SQL Server, este grupo tiene derechos de administrador de forma predeterminada. Esta regla comprueba si el grupo se ha quitado de SQL Server.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1053     |La cuenta con el nombre predeterminado `sa` se debe cambiar o deshabilitar.          |Bajo         |`sa` es una cuenta conocida con el identificador de entidad de seguridad 1. Esta regla comprueba que se haya cambiado el nombre de la cuenta `sa` o que dicha cuenta se haya deshabilitado.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1054     |No se deben conceder permisos excesivos al rol PUBLIC en objetos o columnas.          |Bajo         |Cada inicio de sesión de SQL Server pertenece al rol de servidor público. Cuando a una entidad de seguridad de servidor no se le han concedido ni denegado permisos específicos para un objeto protegible, el usuario hereda los permisos concedidos al rol público en ese objeto. Esta regla muestra una lista de todos los objetos o columnas protegibles a los que pueden acceder todos los usuarios a través del rol PUBLIC.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1058     |El inicio de sesión `sa` debe estar deshabilitado.          |Alto         |`sa` es una cuenta conocida con el identificador de entidad de seguridad 1. Esta regla comprueba que se haya deshabilitado la cuenta `sa`.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1059     |xp_cmdshell debe estar deshabilitado.          |Alto         |xp_cmdshell genera un shell de comandos de Windows y lo pasa a una cadena para su ejecución. Esta regla comprueba que xp_cmdshell esté deshabilitado.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1067     |Las instancias de XP de Correo electrónico de base de datos deben estar deshabilitadas mientras no se usa          |Media         |Esta regla comprueba que Correo electrónico de base de datos esté deshabilitado si no se configura ningún perfil de correo electrónico para la base de datos. La característica Correo electrónico de base de datos se puede usar para enviar mensajes de correo electrónico desde el Motor de base de datos de SQL Server y está deshabilitado de forma predeterminada. Si no va a usar esta característica, se recomienda deshabilitarla para reducir el área expuesta.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1068     |No se deben conceder permisos de servidor directamente a las entidades de seguridad.          |Bajo         |Los permisos de nivel de servidor están asociados a un objeto de nivel de servidor para regular qué usuarios pueden obtener acceso al objeto. Esta regla comprueba que no se han concedido permisos de nivel de servidor directamente a los inicios de sesión.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1070     |Los usuarios de base de datos no deben tener el mismo nombre que un inicio de sesión de servidor.          |Bajo         |Los usuarios de base de datos pueden tener el mismo nombre que un inicio de sesión de servidor. Esta regla valida que no hay usuarios de este tipo.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1072     |El modo de autenticación debe ser autenticación de Windows.          |Media         |Existen dos modos de autenticación posibles: modo de autenticación de Windows y modo mixto. Con el modo mixto, SQL Server habilita la autenticación de Windows y la autenticación de SQL Server. Esta regla comprueba que el modo de autenticación está establecido en autenticación de Windows.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1094     |No se deben conceder permisos de base de datos directamente a las entidades de seguridad.          |Bajo         |Los permisos son reglas asociadas a un objeto protegible para regular qué usuarios pueden obtener acceso al objeto. Esta regla comprueba que no se han concedido permisos de base de datos directamente a los usuarios.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1095     |No se deben conceder permisos excesivos al rol PUBLIC.          |Media         |Cada inicio de sesión de SQL Server pertenece al rol de servidor público. Cuando a una entidad de seguridad de servidor no se le han concedido ni denegado permisos específicos para un objeto protegible, el usuario hereda los permisos concedidos al rol público en ese objeto. Como resultado, se muestra una lista de todos los permisos que se conceden al rol PUBLIC.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1096     |No se deben conceder permisos a la entidad de seguridad GUEST en la base de datos.          |Bajo         |Cada base de datos incluye un usuario denominado GUEST. Los permisos concedidos al usuario GUEST se aplican a todos los usuarios que tienen acceso a la base de datos, pero no disponen de una cuenta en la base de datos. Esta regla comprueba que se hayan revocado todos los permisos al usuario GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1097     |No se deben conceder permisos a la entidad de seguridad GUEST en objetos o columnas.          |Bajo         |Cada base de datos incluye un usuario denominado GUEST. Los permisos concedidos al usuario GUEST se aplican a todos los usuarios que tienen acceso a la base de datos, pero no disponen de una cuenta en la base de datos. Esta regla comprueba que se hayan revocado todos los permisos al usuario GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1099     |No se deben conceder permisos al usuario GUEST en las bases de datos protegibles.          |Bajo         |Cada base de datos incluye un usuario denominado GUEST. Los permisos concedidos al usuario GUEST se aplican a todos los usuarios que tienen acceso a la base de datos, pero no disponen de una cuenta en la base de datos. Esta regla comprueba que se hayan revocado todos los permisos al usuario GUEST.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1246     |Los roles de aplicación no deben usarse.          |Bajo         |Un rol de aplicación es una entidad de seguridad de base de datos que permite que una aplicación se ejecute con sus propios permisos de usuario. Los roles de aplicación permiten que solo los usuarios que se conectan a través de una aplicación determinada puedan acceder a datos específicos. Los roles de aplicación están basados en contraseña (que las aplicaciones suelen codificar de forma rígida) y no en función de los permisos, lo que expone la base de datos a la suplantación de rol de aplicación mediante la adivinación de contraseña. Esta regla comprueba que no hay roles de aplicación definidos en la base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database         |
|VA1248     |Los roles de base de datos definidos por el usuario no deben ser miembros de roles fijos.          |Media         |Para administrar con facilidad los permisos en las bases de datos, SQL Server proporciona varios roles, que son las entidades de seguridad que agrupan otras entidades de seguridad. Son como los grupos del sistema operativo Microsoft Windows. 0Las cuentas de base de datos y otros roles de SQL Server se pueden agregar a los roles de nivel de base de datos. Cada miembro de un rol fijo de base de datos puede agregar otros usuarios a ese mismo rol. Esta regla comprueba que ningún rol definido por el usuario es miembro de los roles fijos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1267     |Los usuarios independientes deben usar la autenticación de Windows.          |Media         |Los usuarios independientes son usuarios que existen en la base de datos y no requieren una asignación de inicio de sesión. Esta regla comprueba que los usuarios independientes usen la autenticación de Windows.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1280     |Los permisos de servidor concedidos al rol público deben minimizarse.          |Media         |Cada inicio de sesión de SQL Server pertenece al rol de servidor público. Cuando a una entidad de seguridad de servidor no se le han concedido ni denegado permisos específicos para un objeto protegible, el usuario hereda los permisos concedidos al rol público en ese objeto. Esta regla comprueba que se han minimizado los permisos de servidor concedidos al rol público.          |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1282     |Se deben quitar los roles huérfanos.          |Bajo         |Los roles huérfanos son roles definidos por el usuario que no tienen miembros. Elimine los roles huérfanos ya que no son necesarios en el sistema. Esta regla comprueba si hay algún rol huérfano.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2020     |Se deben conceder permisos de ámbito de base de datos ALTER o ALTER ANY USER al conjunto mínimo de entidades de seguridad.          |Alto         |Cada protegible de SQL Server tiene permisos asociados que se pueden conceder a las entidades de seguridad. Los permisos se pueden limitar en el nivel de servidor (asignados a los inicios de sesión y roles de servidor) o en el nivel de base de datos (asignados a usuarios de base de datos y roles base de datos). Estas reglas comprueban que solo un conjunto mínimo de entidades de seguridad tenga permisos de ámbito de base de datos ALTER o ALTER ANY USER.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2033     |Se deben conceder permisos de ámbito de base de datos EXECUTE en objetos o columnas al conjunto mínimo de entidades de seguridad.          |Bajo         |Esta regla comprueba a qué entidades de seguridad se les concede el permiso EXECUTE sobre objetos o columnas para asegurarse de que este permiso se ha concedido únicamente a un conjunto mínimo de entidades de seguridad. Cada protegible de SQL Server tiene permisos asociados que se pueden conceder a las entidades de seguridad. Los permisos se pueden limitar en el nivel de servidor (asignados a los inicios de sesión y roles del servidor) o en el nivel de base de datos (asignados a usuarios de bases de datos, roles de base de datos o roles de aplicación). El permiso EXECUTE se aplica a los procedimientos almacenados y a las funciones escalares que se pueden usar en las columnas calculadas.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2103     |Los permisos de ejecución innecesarios en procedimientos almacenados extendidos se deben revocar.          |Media         |Los procedimientos almacenados extendidos son DLL que una instancia de SQL Server puede cargar y ejecutar dinámicamente. SQL Server está empaquetado con muchos procedimientos almacenados extendidos que permiten la interacción con los archivos DLL del sistema. Esta regla comprueba que los permisos de ejecución innecesarios en procedimientos almacenados extendidos se deben revocar.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2107     |Un conjunto mínimo de entidades de seguridad debe ser miembro de roles fijos de la base de datos maestra de Azure SQL DB          |Alto         |SQL Database proporciona dos roles administrativos restringidos en la base de datos maestra a la que se pueden agregar cuentas de usuario que otorgan permisos para crear bases de datos o administrar inicios de sesión. Esta regla comprueba que un conjunto mínimo de entidades de seguridad sea miembro de estos roles administrativos.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse         |
|VA2108     |Un conjunto mínimo de entidades de seguridad debe ser miembro de roles fijos de la base de datos de alto impacto.          |Alto         |SQL Server proporciona roles para ayudar a administrar los permisos. Los roles son entidades de seguridad que agrupan otras entidades de seguridad. Los roles de nivel de base de datos se aplican a toda la base de datos en su ámbito de permisos. Esta regla comprueba que un conjunto mínimo de entidades de seguridad sea miembro de los roles fijos de la base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2109     |Un conjunto mínimo de entidades de seguridad debe ser miembro de roles fijos de la base de datos maestra de bajo impacto.          |Bajo         |SQL Server proporciona roles para ayudar a administrar los permisos. Los roles son entidades de seguridad que agrupan otras entidades de seguridad. Los roles de nivel de base de datos se aplican a toda la base de datos en su ámbito de permisos. Esta regla comprueba que un conjunto mínimo de entidades de seguridad sea miembro de los roles fijos de la base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA2110     |Los permisos de ejecución para acceder al Registro deben revocarse.          |Alto         |Los procedimientos almacenados extendidos del Registro permiten a Microsoft SQL Server leer, escribir y enumerar valores y claves en el Registro. Enterprise Manager los utiliza para configurar el servidor. Esta regla comprueba que los permisos para ejecutar procedimientos almacenados extendidos del Registro se han revocado para todos los usuarios (excepto dbo).         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2113     |Los permisos de Servicios de transformación de datos (DTS) solo se deben conceder a roles de SSIS.          |Media         |Servicios de transformación de datos (DTS) es un conjunto de objetos y utilidades que permiten la automatización de las operaciones de extracción, transformación y carga de datos en una base de datos o desde esta. Los objetos son paquetes DTS y sus componentes, y las utilidades se denominan herramientas de DTS. Esta regla comprueba que solo se concedan permisos a los roles de SSIS para usar los procedimientos almacenados del sistema de DTS y que se hayan revocado los permisos del rol PUBLIC para usar los procedimientos almacenados del sistema de DTS.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2114     |Un conjunto mínimo de entidades de seguridad debe ser miembro de roles fijos del servidor de alto impacto.          |Alto         |SQL Server proporciona roles para ayudar a administrar los permisos. Los roles son entidades de seguridad que agrupan otras entidades de seguridad. Los roles de nivel de servidor se aplican a todo el servidor en su ámbito de permisos. Esta regla comprueba que un conjunto mínimo de entidades de seguridad sean miembros de los roles fijos de servidor.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2129     |Los cambios en los módulos firmados deben autorizarse.          |Alto         |Se puede firmar un procedimiento almacenado, una función o un desencadenador con un certificado o una clave asimétrica. Está diseñado para escenarios en los que los permisos no se pueden heredar a través del encadenamiento de propiedad o cuando se interrumpe la cadena de propiedad, como SQL dinámico. Esta regla comprueba los cambios realizados en los módulos firmados, lo que podría ser una indicación de uso malintencionado.         |<nobr>SQL Server 2012+<nobr/><br/><br/>SQL Database<br/><br/>Instancia administrada de SQL         |
|VA2130     |Se realiza un seguimiento de todos los usuarios con acceso a la base de datos.          |Bajo         |Esta comprobación realiza un seguimiento de todos los usuarios con acceso a una base de datos. Asegúrese de que estos usuarios estén autorizados según su rol actual en la organización.         |<nobr>SQL Database<nobr/><br/><br/>Azure Synapse         |

## <a name="auditing-and-logging"></a>Auditoría y registro

|Id. de regla  |Título de la regla  |Gravedad de la regla  |Descripción de la regla  |Plataforma  |
|---------|---------|---------|---------|---------|
|VA1045     |El seguimiento predeterminado debe estar habilitado.          |Media         |Los seguimientos predeterminados ofrecen ayuda para la solución de problemas a los administradores de bases de datos al garantizar que disponen de los datos de registro necesarios para diagnosticar los problemas la primera vez que ocurren. Esta regla comprueba que el seguimiento predeterminado esté habilitado.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1091     |La auditoría de los intentos de inicio de sesión correctos y erróneos (seguimiento predeterminado) debe estar habilitada si la opción "Auditoría de inicio de sesión" está configurada para realizar el seguimiento de inicios de sesión.          |Bajo         |La configuración de Auditoría de inicio de sesión de SQL Server permite a los administradores realizar un seguimiento de los usuarios que inician sesión en instancias de SQL Server. Si el usuario elige contar con "Auditoría de inicio de sesión" para realizar un seguimiento de los usuarios que inician sesión en instancias de SQL Server, es importante habilitar esta opción para los intentos de inicio de sesión correctos y erróneos.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1093     |El número máximo de registros de errores debe ser 12 o más.          |Bajo         |Cada registro de errores de SQL Server tendrá toda la información relacionada con los errores que se han producido desde que SQL Server se reinició por última vez o desde la última vez que se reciclaron los registros de errores. Esta regla comprueba que el número máximo de registros de errores es 12 o más.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1258     |Los propietarios de bases de datos son los esperados.          |Alto         |Los propietarios de bases de datos pueden realizar todas las actividades de configuración y mantenimiento en la base de datos y también pueden quitar bases de datos en SQL Server. El seguimiento de los propietarios de bases de datos es importante para evitar tener permisos excesivos para algunas entidades de seguridad. Cree una base de referencia para la definición de los propietarios de bases de datos esperados para la base de datos. Esta regla comprueba si los propietarios de bases de datos están definidos en la base de referencia.         |<nobr>SQL Server 2016+<sup>3</sup><nobr/><br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1264     |Se debe habilitar la auditoría de los intentos de inicio de sesión correctos y erróneos.          |Bajo         |Configuración de auditoría de SQL Server permite a los administradores realizar un seguimiento de los usuarios que inician sesión en instancias de SQL Server de las que son responsables. Esta regla comprueba que la auditoría está habilitada para los intentos de inicio de sesión correctos y erróneos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1265     |Se debe habilitar la auditoría de los intentos de inicio de sesión correctos y erróneos para la autenticación de la base de datos.          |Media         |Configuración de auditoría de SQL Server permite a los administradores realizar un seguimiento de los usuarios que inician sesión en instancias de SQL Server de las que son responsables. Esta regla comprueba que la auditoría está habilitada para los intentos de inicio de sesión correctos y erróneos de autenticación de bases de datos independientes.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1281     |Todas las pertenencias a roles definidos por el usuario deben estar previstas.          |Media         |Los roles definidos por el usuario son entidades de seguridad definidas por el usuario para agrupar entidades de seguridad con el fin de administrar los permisos fácilmente. La supervisión de estos roles es importante para evitar tener permisos excesivos. Cree una línea base que defina la pertenencia esperada para cada rol definido por el usuario. Esta regla comprueba si todas las pertenencias de roles definidos por el usuario están definidas en la base de referencia.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1283     |Debe haber al menos 1 auditoría activa en el sistema.          |Bajo         |La auditoría de una instancia del motor de base de datos de SQL Server o una base de datos individual implica el seguimiento y el registro de los eventos que se producen en el motor de base de datos. El objeto SQL Server Audit recopila una única instancia de acciones y grupos de acciones de nivel de servidor o de base de datos para su supervisión. Esta regla comprueba que haya al menos una auditoría activa en el sistema.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2061     |La opción Auditoría debe estar habilitada en el nivel de servidor.          |Alto         |La opción Auditoría de Azure SQL Database realiza el seguimiento de eventos de base de datos y los escribe en un registro de auditoría de la cuenta de Azure Storage. La opción Auditoría le ayuda a comprender la actividad de las bases de datos, y a conocer las discrepancias y anomalías que pueden indicar problemas en el negocio o infracciones de seguridad sospechosas, así como a mantener el cumplimiento normativo. Para más información, consulte [Auditoría de Azure SQL](./auditing-overview.md). Esta regla comprueba que la opción Auditoría esté habilitada.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse          |

## <a name="data-protection"></a>Protección de datos

|Id. de regla  |Título de la regla  |Gravedad de la regla  |Descripción de la regla  |Plataforma  |
|---------|---------|---------|---------|---------|
|VA1098     |Cualquier punto de conexión de SSB o creación de reflejo existente debe requerir la conexión AES.          |Alto         |Los puntos de conexión de Service Broker y creación de reflejo admiten algoritmos de cifrado diferentes, incluida la ausencia de cifrado. Esta regla comprueba que cualquier punto de conexión existente requiere el cifrado AES.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1219     |El cifrado de datos transparente debe habilitarse.          |Media         |Cifrado de datos transparente (TDE) ayuda a proteger los archivos de base de datos frente a la divulgación de información mediante el cifrado y descifrado en tiempo real de la base de datos, las copias de seguridad asociadas y los archivos de registro de transacciones "en reposo" sin necesidad de cambios en la aplicación. Esta regla comprueba que TDE está habilitado en la base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1220     |La comunicación de bases de datos mediante TDS debe protegerse mediante TLS.          |Alto         |Microsoft SQL Server puede usar Capa de sockets seguros (SSL) o Seguridad de la capa de transporte (TLS) para cifrar los datos transmitidos a través de una red entre una instancia de SQL Server y una aplicación cliente. Esta regla comprueba que todas las conexiones a la SQL Server se cifren a través de TLS.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1221     |Las claves simétricas de cifrado de base de datos deben usar el algoritmo AES.          |Alto         |SQL Server usa claves de cifrado para proteger las credenciales de datos y la información de conexión que se almacena en una base de datos de servidor. SQL Server tiene dos tipos de claves: simétricas y asimétricas. Esta regla comprueba que las claves simétricas de cifrado de base de datos usan el algoritmo AES.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1222     |Las claves de cifrado de nivel de celda deben usar el algoritmo AES.          |Alto         |El cifrado de nivel de celda (CLE) permite cifrar los datos mediante claves simétricas y asimétricas. Esta regla comprueba que las claves simétricas de cifrado de nivel de celda usan el algoritmo AES.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1223     |Las claves de certificado deben usar al menos 2048 bits.          |Alto         |Las claves de certificado se utilizan en RSA y en otros algoritmos de cifrado para proteger los datos. Estas claves deben tener una longitud suficiente para proteger los datos del usuario. Esta regla comprueba que la longitud de la clave sea al menos de 2048 bits para todos los certificados.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1224     |Las claves asimétricas deben tener una longitud de 2048 bits como mínimo.          |Alto         |Las claves asimétricas de base de datos se usan en muchos algoritmos de cifrado. Estas claves deben tener una longitud suficiente para proteger los datos cifrados. Esta regla comprueba que todas las claves asimétricas almacenadas en la base de datos tengan una longitud de al menos 2048 bits.         |<nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/>SQL Database         |
|VA1279     |La opción Forzar cifrado debe estar habilitada para TDS.          |Alto         |Cuando la opción Forzar cifrado del Motor de base de datos está habilitada, se cifran todas las comunicaciones entre el cliente y el servidor, independientemente de si la opción "Cifrar conexión" (por ejemplo, de SSMS) está activada. Esta regla comprueba que la opción Forzar cifrado esté habilitada.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1288     |Las columnas de datos confidenciales deben estar clasificadas.          |Media         |Esta regla comprueba si la base de datos analizada tiene datos potencialmente confidenciales que no se hayan clasificado.         |<nobr/>Instancia administrada         |
|VA2060     |La opción Detección de amenazas de SQL debe estar habilitada en el nivel de servidor.          |Media         |La opción Detección de amenazas de SQL proporciona una capa de seguridad que detecta posibles vulnerabilidades y actividades anómalas en bases de datos, como ataques por inyección de código SQL y patrones de comportamiento inusuales. Cuando se detecta una amenaza potencial, Detección de amenazas envía una alerta en tiempo real accionable por correo electrónico y en Azure Security Center, que incluye pasos claros de investigación y corrección para la amenaza específica. Para obtener más información, consulte [Configuración de la detección de amenazas](./threat-detection-configure.md). Comprueba que la opción Detección de amenazas de SQL está habilitada.         |<nobr/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="installation-updates-and-patches"></a>Actualizaciones y revisiones de instalación

|Id. de regla  |Título de la regla  |Gravedad de la regla  |Descripción de la regla  |Plataforma  |
|---------|---------|---------|---------|---------|
| VA1018     |Deben instalarse las últimas actualizaciones          |Alto         |Microsoft publica periódicamente las actualizaciones acumulativas (CU) para cada versión de SQL Server. Esta regla comprueba si se ha instalado la CU más reciente para la versión concreta de SQL Server que se está usando, para lo cual pasa una cadena para su ejecución. Esta regla comprueba que todos los usuarios (excepto dbo) no tengan permiso para ejecutar el procedimiento almacenado extendido xp_cmdshell. |<nobr>SQL Server 2005<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2008<nobr/><br/><br/><nobr>SQL Server 2012<nobr/><br/><br/><nobr>SQL Server 2014<nobr/><br/><br/><nobr>SQL Server 2016<nobr/><br/><br/>SQL Server 2017<br/>|
|VA2128     |No se admite la evaluación de vulnerabilidades para versiones de SQL Server inferiores a SQL Server 2012          |Alto         |Para ejecutar una evaluación de vulnerabilidades en su instancia de SQL Server, el servidor debe actualizarse a SQL Server 2012 o superior. Microsoft ya no admite SQL Server 2008 R2 ni versiones anteriores. Para obtener más información, vea <https://www.microsoft.com/cloud-platform/windows-sql-server-2008>.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |

## <a name="surface-area-reduction"></a>Reducción del área expuesta

|Id. de regla  |Título de la regla  |Gravedad de la regla  |Descripción de la regla  |Plataforma  |
|---------|---------|---------|---------|---------|
|VA1022     |Las consultas distribuidas ad hoc deben estar deshabilitadas.          |Media         |Las consultas distribuidas ad hoc utilizan las funciones `OPENROWSET` y `OPENDATASOURCE` para conectarse a los orígenes de datos remotos que utilizan OLE DB. Esta regla comprueba que las consultas distribuidas ad hoc están deshabilitadas.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1023     |La función CLR debe estar deshabilitada.          |Alto         |La función CLR permite que el código administrado se hospede y se ejecute en el entorno de Microsoft SQL Server. Esta regla comprueba que la función CLR esté deshabilitada.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1026     |La función CLR debe estar deshabilitada.          |Media         |La función CLR permite que el código administrado se hospede y se ejecute en el entorno de Microsoft SQL Server. CLR strict security trata los ensamblados SAFE y EXTERNAL_ACCESS como si estuvieran marcados como UNSAFE y requiere que todos los ensamblados estén firmados mediante un certificado o una clave asimétrica con el correspondiente inicio de sesión que tenga concedido el permiso UNSAFE ASSEMBLY en la base de datos maestra. Esta regla comprueba que la función CLR esté deshabilitada.         |<nobr>SQL Server 2017+<sup>2</sup><nobr/><br/><br/>Instancia administrada de SQL         |
|VA1027     |Los ensamblados de confianza no controlados deben quitarse.          |Alto         |Los ensamblados marcados como UNSAFE deben estar firmados mediante un certificado o una clave asimétrica con el correspondiente inicio de sesión que tenga concedido el permiso UNSAFE ASSEMBLY en la base de datos maestra. Los ensamblados de confianza pueden omitir este requisito.          |<nobr>SQL Server 2017+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1044     |Las conexiones de administración remotas deben estar deshabilitadas, a menos que se requieran específicamente          |Media         |Esta regla comprueba que las conexiones de administración dedicadas remotas están deshabilitadas si no se están utilizando para la agrupación en clústeres para reducir el área expuesta a ataques. SQL Server ofrece una conexión de administrador dedicada (DAC). DAC permite a un administrador acceder a un servidor en ejecución para ejecutar funciones de diagnóstico o instrucciones Transact-SQL, o bien para solucionar problemas en el servidor, y se convierte en un destino atractivo para los ataques cuando se habilita de forma remota.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1051     |AUTO_CLOSE debe deshabilitarse en todas las bases de datos.          |Media         |La opción AUTO_CLOSE especifica si la base de datos se cierra sin problemas y libera los recursos cuando se desconecta el último usuario. Independientemente de sus ventajas, puede provocar la denegación de servicio al abrir y cerrar la base de datos de forma agresiva, por lo que es importante mantener esta característica deshabilitada. Esta regla comprueba que esta opción esté deshabilitada en la base de datos actual.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1066     |Los puntos de conexión de Service Broker no usados deben quitarse.          |Bajo         |Service Broker proporciona puesta en cola y mensajería de confianza para SQL Server. Service Broker se utiliza en las aplicaciones que usan una única instancia de SQL Server y en las aplicaciones que distribuyen el trabajo entre varias instancias. Los puntos de conexión de Service Broker proporcionan opciones para la seguridad de transporte y el reenvío de mensajes. Esta regla enumera todos los puntos de conexión de Service Broker. Quite los que no se usen.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1071     |La opción "Buscar procedimientos de inicio" debe estar deshabilitada.          |Media         |Si la opción "Buscar procedimientos de inicio" está habilitada, SQL Server examina y ejecuta todos los procedimientos almacenados que se ejecutan automáticamente definidos en el servidor. Si esta opción está habilitada, SQL Server examina y ejecuta todos los procedimientos almacenados que se ejecutan automáticamente definidos en el servidor. Esta regla comprueba que esta opción esté deshabilitada.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1092     |La instancia de SQL Server no debe anunciarse en el servicio SQL Server Browser.          |Bajo         |SQL Server utiliza el servicio SQL Server Browser para enumerar las instancias de Motor de base de datos de SQL Server instaladas en el equipo. De esta manera, las aplicaciones cliente pueden buscar un servidor y los clientes pueden distinguir las distintas instancias de Motor de base de datos de SQL Server que están instaladas en el mismo equipo. Esta regla comprueba que la instancia de SQL está oculta.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1102     |El bit de confianza debe estar deshabilitado en todas las bases de datos, excepto MSDB.          |Alto         |La propiedad de base de datos TRUSTWORTHY sirve para indicar si la instancia de SQL Server confía en la base de datos y en su contenido. Si esta opción está habilitada, los módulos de base de datos (por ejemplo, las funciones definidas por el usuario o los procedimientos almacenados) que utilizan un contexto de suplantación pueden acceder a los recursos fuera de la base de datos. Esta regla comprueba que el bit de TRUSTWORTHY esté deshabilitado en todas las bases de datos, excepto MSDB.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1143     |El usuario "dbo" no se debe usar para la operación de servicio normal.          |Media         |El propietario de la base de datos o "dbo" es una cuenta de usuario que tiene permisos implícitos para realizar todas las actividades de la base de datos. Los miembros del rol fijo sysadmin se asignan automáticamente a dbo. Esta regla comprueba que dbo no es la única cuenta que tiene acceso a esta base de datos. Tenga en cuenta que, en una base de datos limpia recién creada, esta regla generará un error hasta que se creen roles adicionales.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL<br/><br/>SQL Database<br/><br/>Azure Synapse         |
|VA1144     |La base de datos modelo solo debe ser accesible para "dbo".          |Media         |La base de datos modelo se utiliza como plantilla para todas las bases de datos creadas en una instancia de SQL Server. Las modificaciones realizadas en la base de datos modelo, como el modelo de recuperación del tamaño de la base de datos y otras opciones de base de datos, se aplican a todas las bases de datos que se crean con posterioridad. Esta regla comprueba que dbo es la única cuenta que tiene permiso de acceso a la base de datos modelo.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1230     |La opción Secuencia de archivos debe estar deshabilitada.          |Alto         |FILESTREAM integra Motor de base de datos de SQL Server con un sistema de archivos NTFS almacenando datos de objetos binarios grandes (BLOB) varbinary (max) como archivos en el sistema de archivos. Las instrucciones Transact-SQL pueden insertar, actualizar, consultar, buscar y realizar copias de seguridad de los datos de FILESTREAM. Al habilitar FILESTREAM en SQL Server, se expone una API de streaming de NTFS adicional, lo cual aumenta la superficie expuesta a ataques y hace que sea propenso a ataques malintencionados. Esta regla comprueba que la función Secuencia de archivos esté deshabilitada.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1235     |Las instancias de XP de replicación de la configuración del servidor se deben deshabilitar          |Media         |Deshabilite las instancias de XP de replicación de la configuración del servidor en desuso para limitar el área expuesta a ataques. Se trata de una opción de configuración solo interna.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1244     |Los usuarios huérfanos deben quitarse de las bases de datos de SQL Server.          |Media         |Un usuario de base de datos que existe en una base de datos pero no tiene el inicio de sesión correspondiente en la base de datos maestra o como un recurso externo (por ejemplo, un usuario de Windows) se denomina usuario huérfano y debe quitarse o reasignarse a un inicio de sesión válido. Esta regla comprueba que no haya usuarios huérfanos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1245     |La información de dbo debe ser coherente entre la base de datos de destino y la maestra.          |Alto         |Hay información redundante sobre la identidad de dbo de cualquier base de datos: los metadatos almacenados en la propia base de datos y los metadatos almacenados en la base de datos maestra. Esta regla comprueba que esta información sea coherente entre la base de datos de destino y la maestra.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1247     |No debe haber ningún Service Pack marcado con inicio automático.          |Alto         |Si SQL Server se ha configurado en "Buscar procedimientos de inicio", el servidor buscará en la base de datos maestra los procedimientos almacenados marcados con inicio automático. Esta regla comprueba que no hay ningún Service Pack marcado con inicio automático.         |<nobr>SQL Server 2012+<nobr/>         |
|VA1256     |Los ensamblados de CLR de usuario no se deben definir en la base de datos.          |Alto         |Los ensamblados de CLR se pueden usar para ejecutar código arbitrario en un proceso de SQL Server. Esta regla comprueba que no hay ensamblados de CLR definidos por el usuario en la base de datos.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA1277     |El cifrado de red de PolyBase debe estar habilitado.          |Alto         |PolyBase es una tecnología que tiene acceso a los datos relacionales y no relacionales y los combina, todo ello desde SQL Server. La opción de cifrado de red de PolyBase configura SQL Server para cifrar los canales de control y de datos cuando se usa PolyBase. Esta regla comprueba que esta opción esté habilitada.         |<nobr>SQL Server 2016+<nobr/>         |
|VA1278     |Crea una base de referencia de proveedores de administración de claves externas.          |Media         |Administración extensible de claves (EKM) de SQL Server permite a los proveedores de módulos de seguridad de hardware (HSM)/EKM de terceros registrar sus módulos en SQL Server. Cuando los usuarios registrados de SQL Server pueden utilizar las claves de cifrado almacenadas en los módulos de EKM, esta regla muestra una lista de los proveedores de EKM que se usan en el sistema.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2062     |Las reglas de firewall de nivel de base de datos no deben conceder acceso excesivo.          |Alto         |El firewall de nivel de Azure SQL Database ayuda a proteger los datos al impedir todo acceso a la base de datos hasta que se especifican las direcciones IP que tienen permiso. Las reglas de firewall de nivel de base de datos otorgan acceso a la base de datos específica según la dirección IP de origen de cada solicitud. Las reglas de firewall de nivel de base de datos para las bases de datos de usuario y maestra solo se pueden crear y administrar a través de Transact-SQL (a diferencia de las reglas de firewall de nivel de servidor, que también se pueden crear y administrar mediante el Azure Portal o PowerShell). Para más información, consulte [Reglas de firewall de IP de Azure SQL Database y Azure Synapse Analytics](./firewall-configure.md). Comprueba que las reglas de firewall en el nivel de base de datos no concedan acceso a más de 255 direcciones IP.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse         |
|VA2063     |Las reglas de firewall de nivel de servidor no deben conceder acceso excesivo.          |Alto         |El firewall de nivel de Azure SQL Server ayuda a proteger el servidor al impedir todo acceso a las bases de datos hasta que se especifican las direcciones IP que tienen permiso. Las reglas de firewall de nivel de servidor otorgan acceso a todas las bases de datos que pertenecen al servidor según la dirección IP de origen de cada solicitud.  Las reglas de firewall de nivel de servidor solo se pueden crear y administrar mediante Transact-SQL, así como a través de Azure Portal o PowerShell. Para más información, consulte [Reglas de firewall de IP de Azure SQL Database y Azure Synapse Analytics](./firewall-configure.md). Comprueba que las reglas de firewall en el nivel de servidor no concedan acceso a más de 255 direcciones IP.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse         |
|VA2064     |Se debe realizar el seguimiento de las reglas de firewall de nivel de base de datos, que deben mantenerse en un mínimo estricto.          |Alto         |El firewall de nivel de Azure SQL Database ayuda a proteger los datos al impedir todo acceso a la base de datos hasta que se especifican las direcciones IP que tienen permiso. Las reglas de firewall de nivel de base de datos otorgan acceso a la base de datos específica según la dirección IP de origen de cada solicitud. Las reglas de firewall de nivel de base de datos para las bases de datos de usuario y maestra solo se pueden crear y administrar a través de Transact-SQL (a diferencia de las reglas de firewall de nivel de servidor, que también se pueden crear y administrar mediante el Azure Portal o PowerShell). Para más información, consulte [Reglas de firewall de IP de Azure SQL Database y Azure Synapse Analytics](./firewall-configure.md). Esta comprobación enumera todas las reglas de firewall de nivel de base de datos, de modo que se puedan identificar y resolver los cambios que se realicen en ellas.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse         |
|VA2065     |Se debe realizar el seguimiento de las reglas de firewall de nivel de servidor, que deben mantenerse en un mínimo estricto.          |Alto         |El firewall de nivel de Azure SQL Server ayuda a proteger sus datos al impedir todo acceso a las bases de datos hasta que se especifican las direcciones IP que tienen permiso. Las reglas de firewall de nivel de servidor otorgan acceso a todas las bases de datos que pertenecen al servidor según la dirección IP de origen de cada solicitud.  Las reglas de firewall de nivel de servidor se pueden crear y administrar mediante Transact-SQL, así como a través de Azure Portal o PowerShell. Para más información, consulte [Reglas de firewall de IP de Azure SQL Database y Azure Synapse Analytics](./firewall-configure.md).  Esta comprobación enumera todas las reglas de firewall de nivel de servidor, de modo que se puedan identificar y resolver los cambios que se realicen en ellas.         |<nobr/>Instancia administrada<br/><br/>Azure Synapse         |
|VA2111     |Se deben quitar las bases de datos de ejemplo.          |Bajo         |Microsoft SQL Server incluye varias bases de datos de ejemplo. Esta regla comprueba si se han quitado las bases de datos de ejemplo.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2120     |Las características que pueden afectar a la seguridad deben deshabilitarse.          |Alto         |SQL Server es capaz de proporcionar una amplia gama de características y servicios. Es posible que algunas de las características y los servicios proporcionados de forma predeterminada no sean necesarios y que su habilitación afecte negativamente a la seguridad del sistema. Esta regla comprueba que estas características estén deshabilitadas.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2121     | La característica "Procedimientos de automatización OLE" debe estar deshabilitada.         |Alto         |SQL Server es capaz de proporcionar una amplia gama de características y servicios. Es posible que algunas de las características y los servicios proporcionados de forma predeterminada no sean necesarios y que su habilitación afecte negativamente a la seguridad del sistema. Use la opción Procedimientos de automatización OLE para especificar si se pueden crear instancias de los objetos de automatización OLE en lotes de Transact-SQL. Estos son los procedimientos almacenados extendidos que permiten a los usuarios de SQL Server ejecutar funciones externas a SQL Server. Independientemente de sus ventajas, también se puede usar para las vulnerabilidades de seguridad, y es conocido como mecanismo para plantar archivos en las máquinas de destino. Se recomienda usar PowerShell como sustituto de esta herramienta. Esta regla comprueba que la característica "Procedimientos de automatización OLE" esté deshabilitada.          |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2122     |La característica "Opciones de usuario" debe estar deshabilitada.          |Media         |SQL Server es capaz de proporcionar una amplia gama de características y servicios. Es posible que algunas de las características y los servicios proporcionados de forma predeterminada no sean necesarios y que su habilitación afecte negativamente a la seguridad del sistema. La característica Opciones de usuario especifica los valores predeterminados globales para todos los usuarios. Hay establecida una lista de opciones de procesamiento de consultas predeterminadas para la duración de la sesión de trabajo de un usuario. La característica Opciones de usuario permite cambiar los valores predeterminados de las opciones SET (si los valores predeterminados del servidor no resultan adecuados). Esta regla comprueba que la característica "Opciones de usuario" esté deshabilitada.         |<nobr>SQL Server 2012+<nobr/><br/><br/>Instancia administrada de SQL         |
|VA2126     |Las características de extensibilidad que puedan afectar a la seguridad deben deshabilitarse si no se necesitan.          |Media         |SQL Server proporciona una amplia gama de características y servicios. Es posible que algunas de las características y los servicios proporcionados de forma predeterminada no sean necesarios y que su habilitación afecte negativamente a la seguridad del sistema. Esta regla comprueba que las configuraciones que permiten la extracción de datos en un origen de datos externo y la ejecución de scripts con determinadas extensiones de lenguaje remotas están deshabilitadas.         |<nobr>SQL Server 2016+<nobr/>         |

## <a name="removed-rules"></a>Reglas eliminadas

|Id. de regla  |Título de la regla  |
|---------|---------|
|VA1021     |Se deben quitar los procedimientos almacenados temporales globales.         |
|VA1024    |El modo auditoría C2 debe estar habilitado |
|VA1069     |Los permisos para seleccionar en las tablas y vistas del sistema se deben revocar para los usuarios que no sean sysadmin.         |
|VA1090    |Asegúrese de que todos los procedimientos almacenados personalizados y productos Government Off The Shelf (GOTS) están cifrados |
|VA1103    |Use solo CLR con el permiso SAFE_ACCESS |
|VA1229     |La configuración de secuencia de archivos en el registro y en la configuración de SQL Server debe coincidir.         |
|VA1231     |La opción Secuencia de archivos debe estar deshabilitada (SQL).         |
|VA1234     |La opción Criterios comunes debe estar habilitada.         |
|VA1252     |Lista de eventos que se están auditando y que se administran de forma centralizada mediante especificaciones de auditoría de servidor.         |
|VA1253     |Lista de eventos de ámbito de base de datos que se están auditando y que se administran de forma centralizada mediante especificaciones de auditoría de servidor.         |
|VA1263     |Enumera todas las auditorías activas del sistema.         |
|VA1266     |La opción "MUST_CHANGE" debe establecerse en todos los inicios de sesión de SQL.         |
|VA1276     |La característica Agent XPs debe estar deshabilitada.         |
|VA1286     |No se deben conceder permisos de base de datos directamente a las entidades de seguridad (OBJECT o COLUMN).         |
|VA2000     |Se deben conceder permisos de ámbito de base de datos de alto impacto al conjunto mínimo de entidades de seguridad.         |
|VA2001     |Se deben conceder permisos de ámbito de base de datos de alto impacto en objetos o columnas al conjunto mínimo de entidades de seguridad.         |
|VA2002     |Se deben conceder permisos de ámbito de base de datos de alto impacto en distintos protegibles al conjunto mínimo de entidades de seguridad.         |
|VA2010     |Se deben conceder permisos de ámbito de base de datos de impacto medio al conjunto mínimo de entidades de seguridad.         |
|VA2021     |Se deben conceder permisos de ámbito de base de datos ALTER en objetos o columnas al conjunto mínimo de entidades de seguridad.         |
|VA2022     |Se deben conceder permisos de ámbito de base de datos ALTER en distintos protegibles al conjunto mínimo de entidades de seguridad.         |
|VA2030     |Se deben conceder permisos de ámbito de base de datos SELECT o EXECUTE al conjunto mínimo de entidades de seguridad.         |
|VA2031     |Se deben conceder permisos de ámbito de base de datos SELECT al conjunto mínimo de entidades de seguridad.          |
|VA2032     |Se deben conceder permisos de ámbito de base de datos SELECT o EXECUTE al conjunto mínimo de entidades de seguridad en el esquema.         |
|VA2034     |Se deben conceder permisos de ámbito de base de datos EXECUTE en la colección de esquemas XML al conjunto mínimo de entidades de seguridad.         |
|VA2040     |Se deben conceder permisos de ámbito de base de datos de bajo impacto al conjunto mínimo de entidades de seguridad.         |
|VA2041     |Se deben conceder permisos de ámbito de base de datos de bajo impacto en objetos o columnas al conjunto mínimo de entidades de seguridad.         |
|VA2042     |Se deben conceder permisos de ámbito de base de datos de bajo impacto al conjunto mínimo de entidades de seguridad en el esquema.         |
|VA2050     |Se deben conceder permisos de ámbito de base de datos VIEW DEFINITION al conjunto mínimo de entidades de seguridad.         |
|VA2051     |Se deben conceder permisos de ámbito de base de datos VIEW DEFINITION en objetos o columnas al conjunto mínimo de entidades de seguridad.         |
|VA2052     |Se deben conceder permisos de ámbito de base de datos VIEW DEFINITION en distintos protegibles al conjunto mínimo de entidades de seguridad.         |
|VA2100     |Se deben conceder permisos de ámbito de servidor de alto impacto al conjunto mínimo de entidades de seguridad.         |
|VA2101     |Se deben conceder permisos de ámbito de servidor de impacto medio al conjunto mínimo de entidades de seguridad.         |
|VA2102     |Se deben conceder permisos de ámbito de servidor de bajo impacto al conjunto mínimo de entidades de seguridad.         |
|VA2104     |Los permisos de ejecución en procedimientos almacenados extendidos se deben revocar desde el rol PUBLIC.         |
|VA2105     |La contraseña de inicio de sesión no se debe poder adivinar fácilmente.         |
|VA2112     |Se deben revocar los permisos de PUBLIC para servicios de transformación de datos (DTS).         |
|VA2115     |Un conjunto mínimo de entidades de seguridad debe ser miembro de roles fijos del servidor de impacto medio.         |
|VA2123     |La característica "Acceso remoto" debe estar deshabilitada.         |
|VA2127     |La característica "Scripts externos" debe estar deshabilitada.         |

## <a name="next-steps"></a>Pasos siguientes

- [Evaluación de vulnerabilidad](sql-vulnerability-assessment.md)
- [Registro de cambios de reglas de valoración de vulnerabilidades de SQL](sql-database-vulnerability-assessment-rules-changelog.md)
